{"uid":"82aa443d46389b89","name":"test_send_and_receive_with_correct_invoice_for_rgb20","fullName":"test.spec.test_rgb20_channel_tx#test_send_and_receive_with_correct_invoice_for_rgb20","historyId":"12fac95ca2ddef0057de31952e7ca44a","time":{"start":1763720622762,"stop":1763722180234,"duration":1557472},"description":"Test sending and receiving with correct invoice for RGB20","descriptionHtml":"<p>Test sending and receiving with correct invoice for RGB20</p>\n","status":"broken","statusMessage":"TypeError: expected string or bytes-like object, got 'NoneType'","statusTrace":"wallets_and_operations = WalletTestSetup(first_page_features=<e2e_tests.test.features.main_features.MainFeatures object at 0x7f1a1c682090>, sec...e_operations=<e2e_tests.test.utilities.base_operation.BaseOperations object at 0x7f1a15f30a10>, wallet_mode='embedded')\n\n    @allure.feature('Channel send and receive for RGB20 asset')\n    @allure.story('Send and receive with correct invoice for RGB20 asset')\n    def test_send_and_receive_with_correct_invoice_for_rgb20(wallets_and_operations: WalletTestSetup):\n        \"\"\"Test sending and receiving with correct invoice for RGB20\"\"\"\n        node_uri = None\n    \n        with allure.step('Create and fund first wallet for rgb20 channel'):\n            wallets_and_operations.first_page_features.wallet_features.create_and_fund_wallet(\n                wallets_and_operations=wallets_and_operations, application=FIRST_APPLICATION, application_url=FIRST_APPLICATION_URL,\n            )\n    \n        with allure.step('Create and fund second wallet for rgb20 channel'):\n            wallets_and_operations.second_page_features.wallet_features.create_and_fund_wallet(\n                wallets_and_operations=wallets_and_operations, application=SECOND_APPLICATION, application_url=SECOND_APPLICATION_URL,\n            )\n    \n        with allure.step('Issue RGB20 asset'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            wallets_and_operations.first_page_features.issue_rgb20_features.issue_rgb20_with_sufficient_sats_and_utxo(\n                application=FIRST_APPLICATION, asset_ticker=ASSET_TICKER, asset_name=ASSET_NAME, asset_amount=ASSET_AMOUNT,\n            )\n    \n        with allure.step('Get node URI for rgb20 channel'):\n            if wallets_and_operations.wallet_mode == 'embedded':\n                node_uri = wallets_and_operations.second_page_features.channel_features.get_node_uri_for_embedded(\n                    application=SECOND_APPLICATION, ip_address=IP_ADDRESS,\n                )\n            else:\n                node_uri = wallets_and_operations.second_page_features.channel_features.get_node_uri_for_remote(\n                    application=SECOND_APPLICATION, ip_address=IP_ADDRESS, ln_port=LN_PORT,\n                )\n    \n        with allure.step('Create channel for rgb20'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            _channel_status = wallets_and_operations.first_page_features.channel_features.create_channel(\n                application=FIRST_APPLICATION, node_uri=node_uri, asset_ticker=ASSET_TICKER, asset_amount=CREATE_ASSET_CHANNEL_WITH_AMOUNT, channel_capacity=CHANNEL_CAPACITY,\n            )\n    \n        with allure.step('Create invoice'):\n            wallets_and_operations.second_page_operations.do_focus_on_application(\n                SECOND_APPLICATION,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_receive_button()\n            _, invoice = wallets_and_operations.second_page_features.receive_features.receive(\n                application=SECOND_APPLICATION, transfer_type=TransferType.LIGHTNING.value, value=INVOICE_AMOUNT,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n    \n        with allure.step('Send with invoice'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            wallets_and_operations.first_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.first_page_objects.asset_detail_page_objects.click_send_button()\n            wallets_and_operations.first_page_features.send_features.send(\n                application=FIRST_APPLICATION, receiver_invoice=invoice, transfer_type=TransferType.LIGHTNING.value,\n            )\n    \n        with allure.step('validate transaction amount'):\n            wallets_and_operations.second_page_operations.do_focus_on_application(\n                SECOND_APPLICATION,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_rgb_transaction_lightning_frame()\n            transferred_amount = wallets_and_operations.second_page_objects.asset_transaction_detail_page_objects.get_transferred_amount()\n            wallets_and_operations.second_page_objects.asset_transaction_detail_page_objects.click_close_button()\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_close_button()\n>           transferred_amount = re.sub(r'[^\\d.]', '', transferred_amount)\n\ne2e_tests/test/spec/test_rgb20_channel_tx.py:114: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npattern = '[^\\\\d.]', repl = '', string = None, count = 0, flags = 0\n\n    def sub(pattern, repl, string, count=0, flags=0):\n        \"\"\"Return the string obtained by replacing the leftmost\n        non-overlapping occurrences of the pattern in string by the\n        replacement repl.  repl can be either a string or a callable;\n        if a string, backslash escapes in it are processed.  If it is\n        a callable, it's passed the Match object and must return\n        a replacement string to be used.\"\"\"\n>       return _compile(pattern, flags).sub(repl, string, count)\nE       TypeError: expected string or bytes-like object, got 'NoneType'\n\n/opt/hostedtoolcache/Python/3.12.3/x64/lib/python3.12/re/__init__.py:186: TypeError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"load_qm_translation","time":{"start":1763720614377,"stop":1763720614473,"duration":96},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_environment","time":{"start":1763720614474,"stop":1763720622762,"duration":8288},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"wallets_and_operations","time":{"start":1763720622762,"stop":1763720622762,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test sending and receiving with correct invoice for RGB20","status":"broken","statusMessage":"TypeError: expected string or bytes-like object, got 'NoneType'","statusTrace":"wallets_and_operations = WalletTestSetup(first_page_features=<e2e_tests.test.features.main_features.MainFeatures object at 0x7f1a1c682090>, sec...e_operations=<e2e_tests.test.utilities.base_operation.BaseOperations object at 0x7f1a15f30a10>, wallet_mode='embedded')\n\n    @allure.feature('Channel send and receive for RGB20 asset')\n    @allure.story('Send and receive with correct invoice for RGB20 asset')\n    def test_send_and_receive_with_correct_invoice_for_rgb20(wallets_and_operations: WalletTestSetup):\n        \"\"\"Test sending and receiving with correct invoice for RGB20\"\"\"\n        node_uri = None\n    \n        with allure.step('Create and fund first wallet for rgb20 channel'):\n            wallets_and_operations.first_page_features.wallet_features.create_and_fund_wallet(\n                wallets_and_operations=wallets_and_operations, application=FIRST_APPLICATION, application_url=FIRST_APPLICATION_URL,\n            )\n    \n        with allure.step('Create and fund second wallet for rgb20 channel'):\n            wallets_and_operations.second_page_features.wallet_features.create_and_fund_wallet(\n                wallets_and_operations=wallets_and_operations, application=SECOND_APPLICATION, application_url=SECOND_APPLICATION_URL,\n            )\n    \n        with allure.step('Issue RGB20 asset'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            wallets_and_operations.first_page_features.issue_rgb20_features.issue_rgb20_with_sufficient_sats_and_utxo(\n                application=FIRST_APPLICATION, asset_ticker=ASSET_TICKER, asset_name=ASSET_NAME, asset_amount=ASSET_AMOUNT,\n            )\n    \n        with allure.step('Get node URI for rgb20 channel'):\n            if wallets_and_operations.wallet_mode == 'embedded':\n                node_uri = wallets_and_operations.second_page_features.channel_features.get_node_uri_for_embedded(\n                    application=SECOND_APPLICATION, ip_address=IP_ADDRESS,\n                )\n            else:\n                node_uri = wallets_and_operations.second_page_features.channel_features.get_node_uri_for_remote(\n                    application=SECOND_APPLICATION, ip_address=IP_ADDRESS, ln_port=LN_PORT,\n                )\n    \n        with allure.step('Create channel for rgb20'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            _channel_status = wallets_and_operations.first_page_features.channel_features.create_channel(\n                application=FIRST_APPLICATION, node_uri=node_uri, asset_ticker=ASSET_TICKER, asset_amount=CREATE_ASSET_CHANNEL_WITH_AMOUNT, channel_capacity=CHANNEL_CAPACITY,\n            )\n    \n        with allure.step('Create invoice'):\n            wallets_and_operations.second_page_operations.do_focus_on_application(\n                SECOND_APPLICATION,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_receive_button()\n            _, invoice = wallets_and_operations.second_page_features.receive_features.receive(\n                application=SECOND_APPLICATION, transfer_type=TransferType.LIGHTNING.value, value=INVOICE_AMOUNT,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n    \n        with allure.step('Send with invoice'):\n            wallets_and_operations.first_page_operations.do_focus_on_application(\n                FIRST_APPLICATION,\n            )\n            wallets_and_operations.first_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.first_page_objects.asset_detail_page_objects.click_send_button()\n            wallets_and_operations.first_page_features.send_features.send(\n                application=FIRST_APPLICATION, receiver_invoice=invoice, transfer_type=TransferType.LIGHTNING.value,\n            )\n    \n        with allure.step('validate transaction amount'):\n            wallets_and_operations.second_page_operations.do_focus_on_application(\n                SECOND_APPLICATION,\n            )\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.fungible_page_objects.click_rgb20_frame(\n                asset_name=ASSET_NAME,\n            )\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_refresh_button()\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_rgb_transaction_lightning_frame()\n            transferred_amount = wallets_and_operations.second_page_objects.asset_transaction_detail_page_objects.get_transferred_amount()\n            wallets_and_operations.second_page_objects.asset_transaction_detail_page_objects.click_close_button()\n            wallets_and_operations.second_page_objects.asset_detail_page_objects.click_close_button()\n>           transferred_amount = re.sub(r'[^\\d.]', '', transferred_amount)\n\ne2e_tests/test/spec/test_rgb20_channel_tx.py:114: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npattern = '[^\\\\d.]', repl = '', string = None, count = 0, flags = 0\n\n    def sub(pattern, repl, string, count=0, flags=0):\n        \"\"\"Return the string obtained by replacing the leftmost\n        non-overlapping occurrences of the pattern in string by the\n        replacement repl.  repl can be either a string or a callable;\n        if a string, backslash escapes in it are processed.  If it is\n        a callable, it's passed the Match object and must return\n        a replacement string to be used.\"\"\"\n>       return _compile(pattern, flags).sub(repl, string, count)\nE       TypeError: expected string or bytes-like object, got 'NoneType'\n\n/opt/hostedtoolcache/Python/3.12.3/x64/lib/python3.12/re/__init__.py:186: TypeError","steps":[{"name":"Create and fund first wallet for rgb20 channel","time":{"start":1763720622763,"stop":1763720993064,"duration":370301},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Create and fund second wallet for rgb20 channel","time":{"start":1763720993064,"stop":1763721016830,"duration":23766},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Issue RGB20 asset","time":{"start":1763721016830,"stop":1763721198240,"duration":181410},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Get node URI for rgb20 channel","time":{"start":1763721198240,"stop":1763721205578,"duration":7338},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Create channel for rgb20","time":{"start":1763721205579,"stop":1763721629612,"duration":424033},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Create invoice","time":{"start":1763721629612,"stop":1763721874931,"duration":245319},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Send with invoice","time":{"start":1763721874931,"stop":1763721997193,"duration":122262},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"validate transaction amount","time":{"start":1763721997193,"stop":1763722180233,"duration":183040},"status":"broken","statusMessage":"TypeError: expected string or bytes-like object, got 'NoneType'\n","statusTrace":"  File \"/home/runner/work/iris-wallet-desktop/iris-wallet-desktop/e2e_tests/test/spec/test_rgb20_channel_tx.py\", line 114, in test_send_and_receive_with_correct_invoice_for_rgb20\n    transferred_amount = re.sub(r'[^\\d.]', '', transferred_amount)\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/hostedtoolcache/Python/3.12.3/x64/lib/python3.12/re/__init__.py\", line 186, in sub\n    return _compile(pattern, flags).sub(repl, string, count)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"67c1bd214b4c36dd","name":"Screenshot on failure: test_send_and_receive_with_correct_invoice_for_rgb20","source":"67c1bd214b4c36dd.png","type":"image/png","size":1104377}],"parameters":[],"stepsCount":8,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"test_environment::0","time":{"start":1763722364230,"stop":1763722364238,"duration":8},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"Channel send and receive for RGB20 asset"},{"name":"story","value":"Send and receive with correct invoice for RGB20 asset"},{"name":"parentSuite","value":"test.spec"},{"name":"suite","value":"test_rgb20_channel_tx"},{"name":"host","value":"runnervmfxdz0"},{"name":"thread","value":"5786-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test.spec.test_rgb20_channel_tx"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"82aa443d46389b89.json","parameterValues":[]}